

## 🧩 一、typeof 操作符

### ✅ 基本语法

```js
typeof value
```

### ✅ 案例

```js
console.log(typeof 123);          // "number"
console.log(typeof 'abc');        // "string"
console.log(typeof true);         // "boolean"
console.log(typeof undefined);    // "undefined"
console.log(typeof Symbol());     // "symbol"
console.log(typeof 123n);         // "bigint"
console.log(typeof function(){}); // "function"
console.log(typeof {});           // "object"
console.log(typeof []);           // "object"
console.log(typeof null);         // "object" ❌（历史遗留Bug）
```

### ✅ 优点

* 简单直观
* 可检测**基本类型**（number、string、boolean、undefined、symbol、bigint、function）

### ❌ 缺点

* 无法区分 `null`、`array`、`object`
* 对自定义对象检测不准确

---

## 🧠 二、instanceof 操作符

### ✅ 基本语法

```js
value instanceof Constructor
```

### ✅ 案例

```js
console.log([] instanceof Array);       // true
console.log({} instanceof Object);      // true
console.log(new Date() instanceof Date);// true
console.log(/abc/ instanceof RegExp);   // true

function Person() {}
const p = new Person();
console.log(p instanceof Person);       // true
```

### ✅ 原理

* 判断**构造函数的 prototype** 是否出现在实例对象的 **原型链上**

### ✅ 优点

* 可检测复杂对象（数组、日期、正则、自定义类实例）

### ❌ 缺点

* **无法检测基本类型**
* 跨 iframe / 跨 window 会失败（因为原型链不同）

---

## ⚙️ 三、Object.prototype.toString.call()

### ✅ 案例

```js
console.log(Object.prototype.toString.call(123));         // [object Number]
console.log(Object.prototype.toString.call('abc'));       // [object String]
console.log(Object.prototype.toString.call(true));        // [object Boolean]
console.log(Object.prototype.toString.call(undefined));   // [object Undefined]
console.log(Object.prototype.toString.call(null));        // [object Null]
console.log(Object.prototype.toString.call([]));          // [object Array]
console.log(Object.prototype.toString.call({}));          // [object Object]
console.log(Object.prototype.toString.call(new Date()));  // [object Date]
console.log(Object.prototype.toString.call(/abc/));       // [object RegExp]
```

### ✅ 原理

* 所有对象继承自 `Object.prototype`
* 该方法返回对象内部属性 `[[Class]]` 的字符串形式

### ✅ 优点

* 最准确、最通用的检测方法
* 适合检测**任意类型**

### ✅ 封装经典函数

```js
function getType(value) {
  return Object.prototype.toString.call(value).slice(8, -1);
}

console.log(getType([]));         // Array
console.log(getType(null));       // Null
console.log(getType(123));        // Number
console.log(getType(new Date())); // Date
console.log(getType(() => {}));   // Function
```

---

## 💡 四、Array.isArray()

### ✅ 案例

```js
console.log(Array.isArray([]));        // true
console.log(Array.isArray({}));        // false
```

### ✅ 优点

* 专门检测数组，性能高、简单
* 比 `instanceof Array` 更可靠（跨 iframe 不受影响）

---

## 🔍 五、constructor 属性

### ✅ 案例

```js
console.log((123).constructor === Number);         // true
console.log(('abc').constructor === String);       // true
console.log(([]).constructor === Array);           // true
console.log(({}).constructor === Object);          // true
console.log((new Date()).constructor === Date);    // true
```

### ✅ 优点

* 可检测对象的构造函数

### ❌ 缺点

* 构造函数可以被修改（不安全）
* null / undefined 没有 constructor

```js
const a = [];
a.constructor = Object;
console.log(a.constructor === Array); // false ❌
```

---

## ⚡ 六、ES6 新类型检测方式（Symbol、BigInt）

```js
console.log(typeof Symbol('x')); // "symbol"
console.log(typeof 10n);         // "bigint"
```

这两种类型只能用 `typeof` 检测。

---

## 🧭 七、综合比较

| 检测方式                      | 能检测类型 | 准确度 | 跨 iframe | 备注                     |
| ------------------------- | ----- | --- | -------- | ---------------------- |
| typeof                    | 基本类型  | 一般  | ✅        | 无法区分 null、object、array |
| instanceof                | 对象类型  | 一般  | ❌        | 基于原型链                  |
| Object.prototype.toString | 所有类型  | ✅✅✅ | ✅        | 最准确通用                  |
| Array.isArray             | 数组    | ✅✅  | ✅        | 推荐用于检测数组               |
| constructor               | 对象    | 一般  | ❌        | 容易被修改                  |

---

## 🧠 八、经典面试题

```js
typeof null          // "object"
typeof NaN           // "number"
[] instanceof Object // true
typeof []            // "object"
getType(new Number(5)) // "Number"
getType(() => {})    // "Function"
```

---

## ✅ 总结建议

| 场景                               | 推荐方式                               |
| -------------------------------- | ---------------------------------- |
| 判断基本类型（number、string、boolean...） | `typeof`                           |
| 判断数组                             | `Array.isArray()`                  |
| 判断精确类型                           | `Object.prototype.toString.call()` |
| 判断对象实例                           | `instanceof`                       |
| 自定义工具函数                          | 结合多种方式封装                           |

---

是否希望我帮你写一个「完整的类型检测工具函数库」，包含所有这些检测方法的封装（像 lodash 的 `isArray`、`isObject`、`isFunction` 那样）？
