### **1ï¸âƒ£ Webpack æ‰“åŒ…æ—¶å‘ç”Ÿäº†å“ªäº›æ­¥éª¤ï¼Ÿ**

Webpack æ‰“åŒ…å¤§è‡´ç»å†ä»¥ä¸‹æµç¨‹ï¼ˆä»æºç åˆ° bundleï¼‰ï¼š

1. **åˆå§‹åŒ–å‚æ•°**ï¼šè¯»å–é…ç½®æ–‡ä»¶ï¼ˆ`webpack.config.js`ï¼‰å¹¶åˆå¹¶ CLI ä¼ å…¥å‚æ•°ã€‚
2. **åˆ›å»º Compiler å®ä¾‹**ï¼šæ•´ä¸ªæ„å»ºè¿‡ç¨‹çš„æ ¸å¿ƒå¯¹è±¡ã€‚
3. **å¼€å§‹ç¼–è¯‘**ï¼šæ‰§è¡Œ `compiler.run()`ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ **Compilation** å®ä¾‹ã€‚
4. **ä» Entry å…¥å£å‡ºå‘**ï¼šæ ¹æ®å…¥å£ï¼ˆentryï¼‰å¼€å§‹è§£æä¾èµ–å›¾ã€‚
5. **æ¨¡å—ç¼–è¯‘**ï¼š

   * ä½¿ç”¨ Loader å¯¹ä¸åŒç±»å‹æ–‡ä»¶è¿›è¡Œè½¬è¯‘ï¼ˆå¦‚ `.vue`, `.ts`, `.scss`ï¼‰ã€‚
   * å°†æ¨¡å—è½¬æ¢ä¸ºæ ‡å‡†çš„ JS æ¨¡å—ï¼ˆCommonJS æ ¼å¼ï¼‰ã€‚
6. **ä¾èµ–æ”¶é›†**ï¼šåœ¨è§£ææ¨¡å—æ—¶é€’å½’åˆ†æ `import/require` çš„ä¾èµ–ï¼Œå½¢æˆä¾èµ–å›¾ã€‚
7. **Chunk ç”Ÿæˆ**ï¼šå°†å¤šä¸ªæ¨¡å—æ ¹æ®å…¥å£æˆ–åŠ¨æ€åŠ è½½ç‚¹æ‰“åŒ…æˆä¸åŒçš„ chunkã€‚
8. **è¾“å‡ºé˜¶æ®µ**ï¼šç”Ÿæˆæœ€ç»ˆçš„ bundle æ–‡ä»¶å¹¶å†™å…¥åˆ° `output` ç›®å½•ã€‚
9. **å®Œæˆä¸æ¸…ç†**ï¼šè§¦å‘ `done` é’©å­ï¼Œæ‰§è¡Œåç½®æ’ä»¶é€»è¾‘ã€‚

ğŸ§  **é¢è¯•æ€è·¯**ï¼šWebpack æ ¸å¿ƒæ˜¯â€œä»å…¥å£å‡ºå‘ â†’ é€’å½’ä¾èµ– â†’ Loader è½¬æ¢ â†’ Plugin æ‰©å±• â†’ è¾“å‡ºç»“æœâ€ã€‚

---

### **2ï¸âƒ£ Webpack çš„ä¾èµ–æ”¶é›†æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ**

Webpack æ„å»ºæ—¶ï¼Œä¼šä½¿ç”¨ **ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰** æ¥åˆ†æä»£ç ç»“æ„ï¼š

1. è°ƒç”¨ **Parserï¼ˆè§£æå™¨ï¼‰** å°†æ¨¡å—æºä»£ç è½¬æˆ ASTã€‚
2. éå† ASTï¼Œè¯†åˆ«å‡ºï¼š

   * `import ... from ...`
   * `require(...)`
   * åŠ¨æ€ `import()`
3. æŠŠä¾èµ–æ¨¡å—è·¯å¾„æ”¶é›†èµ·æ¥ï¼ŒåŠ å…¥ä¾èµ–å›¾ã€‚
4. é€’å½’åˆ†ææ¯ä¸€ä¸ªä¾èµ–æ¨¡å—ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚

æœ€ç»ˆå½¢æˆä¸€ä¸ª**æ¨¡å—ä¾èµ–å›¾ï¼ˆModule Graphï¼‰**ï¼ŒWebpack å°±èƒ½æ®æ­¤æ‰“åŒ…å‡ºæ•´ä¸ªé¡¹ç›®ã€‚

---

### **3ï¸âƒ£ Loader çš„æ‰§è¡Œé¡ºåºæ˜¯æ€æ ·çš„ï¼Ÿ**

Loader æ˜¯ä¸€ä¸ª **å‡½æ•°é“¾**ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š

> **ä»å³åˆ°å·¦ï¼ˆä»ä¸‹åˆ°ä¸Šï¼‰æ‰§è¡Œã€‚**

åŸå› ï¼šWebpack é‡‡ç”¨â€œç®¡é“æµâ€æ€æƒ³ï¼Œåä¸€ä¸ª loader çš„è¾“å‡ºä¼šä½œä¸ºå‰ä¸€ä¸ªçš„è¾“å…¥ã€‚

ğŸ“¦ ä¾‹å¦‚ï¼š

```js
use: ['style-loader', 'css-loader', 'postcss-loader']
```

æ‰§è¡Œé¡ºåºï¼š

1. `postcss-loader`
2. `css-loader`
3. `style-loader`

å¦‚æœ loader æ˜¯ **pitching loader**ï¼Œåˆ™è¿˜æœ‰ä¸€ä¸ªâ€œä»å·¦åˆ°å³â€çš„å‰ç½®æ‰§è¡Œé˜¶æ®µã€‚

---

### **4ï¸âƒ£ Plugin çš„æ‰§è¡ŒåŸç†ï¼Ÿ**

Webpack çš„æ’ä»¶ç³»ç»ŸåŸºäº **Tapable åº“**ï¼ˆå®ç°å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼‰ã€‚

ğŸ“¦ æœºåˆ¶ç®€è¿°ï¼š

* Webpack åœ¨è¿è¡Œæ—¶ï¼Œä¼šåœ¨ä¸åŒé˜¶æ®µè§¦å‘ä¸€ç³»åˆ— **é’©å­ï¼ˆhooksï¼‰**ã€‚
* æ’ä»¶é€šè¿‡æ³¨å†Œè¿™äº›é’©å­ï¼ˆ`compiler.hooks.emit.tapAsync()` ç­‰ï¼‰æ¥æ‰§è¡Œé€»è¾‘ã€‚
* æ¯”å¦‚ï¼š`HtmlWebpackPlugin` åœ¨ `emit` é˜¶æ®µä¿®æ”¹è¾“å‡ºèµ„æºã€‚

ğŸ”§ ç¤ºä¾‹ï¼š

```js
class MyPlugin {
  apply(compiler) {
    compiler.hooks.emit.tap('MyPlugin', (compilation) => {
      console.log('emit é˜¶æ®µè§¦å‘');
    });
  }
}
```

---

### **5ï¸âƒ£ Webpack çš„æ„å»ºç”Ÿå‘½å‘¨æœŸï¼ˆCompilerã€Compilationï¼‰**

Webpack æœ‰ä¸¤ä¸ªæ ¸å¿ƒå¯¹è±¡ï¼š

* **Compiler**ï¼šæ•´ä¸ª Webpack ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†è€…ï¼ˆå…¨å±€å”¯ä¸€ï¼‰ã€‚
* **Compilation**ï¼šä¸€æ¬¡æ„å»ºè¿‡ç¨‹çš„ä¸Šä¸‹æ–‡ï¼ˆæ¯æ¬¡ç¼–è¯‘éƒ½æ–°å»ºä¸€ä¸ªï¼‰ã€‚

ğŸ” **å¸¸è§ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š**

| é˜¶æ®µ            | ä½œç”¨               |
| ------------- | ---------------- |
| `environment` | åˆå§‹åŒ–ç¯å¢ƒ            |
| `run`         | å¼€å§‹ä¸€æ¬¡ç¼–è¯‘           |
| `compile`     | åˆ›å»ºæ–°çš„ Compilation |
| `make`        | ä» entry å¼€å§‹è§£æä¾èµ–   |
| `emit`        | è¾“å‡ºæ–‡ä»¶åˆ°ç£ç›˜å‰         |
| `done`        | æ„å»ºå®Œæˆ             |

ğŸ§  é¢è¯•å…³é”®è¯ï¼šâ€œCompiler ç®¡å…¨å±€ã€Compilation ç®¡å•æ¬¡ç¼–è¯‘â€ã€‚

---

### **6ï¸âƒ£ Webpack å¦‚ä½•è§£ææ¨¡å—è·¯å¾„ï¼Ÿ**

Webpack ä½¿ç”¨è‡ªå®šä¹‰çš„æ¨¡å—è§£æå™¨ï¼ˆåŸºäº enhanced-resolveï¼‰ï¼š

è§£ææ­¥éª¤ï¼š

1. æ£€æŸ¥æ˜¯å¦ä¸ºç»å¯¹è·¯å¾„ï¼›
2. è‹¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆ`./`ã€`../`ï¼‰ï¼Œä»å½“å‰æ–‡ä»¶ç›®å½•è§£æï¼›
3. è‹¥ä¸ºæ¨¡å—åï¼š

   * æŸ¥æ‰¾ `resolve.alias`
   * æŸ¥æ‰¾ `resolve.modules`ï¼ˆé»˜è®¤ `node_modules`ï¼‰
   * æŸ¥æ‰¾ `resolve.extensions`ï¼ˆå¦‚ `.js`, `.ts`, `.jsx`ï¼‰
   * éµå¾ª Node.js æ¨¡å—è§£æç®—æ³•ã€‚

---

### **7ï¸âƒ£ ä»€ä¹ˆæ˜¯ Chunkï¼Ÿä»€ä¹ˆæ˜¯ Bundleï¼Ÿ**

| åç§°         | å«ä¹‰                           |
| ---------- | ---------------------------- |
| **Chunk**  | Webpack åœ¨æ„å»ºæ—¶çš„å†…éƒ¨æ¦‚å¿µï¼Œä»£è¡¨ä¸€ç»„æ¨¡å—çš„é›†åˆã€‚ |
| **Bundle** | Chunk æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶ï¼ˆå†™å…¥ç£ç›˜çš„äº§ç‰©ï¼‰ã€‚      |

ğŸ§© ä¸¾ä¾‹ï¼š

* entry â†’ `main` chunk
* åŠ¨æ€ import â†’ `vendors~login` chunk
* æœ€ç»ˆè¾“å‡º â†’ `main.bundle.js`ã€`vendors~login.bundle.js`

---

### **8ï¸âƒ£ Hashã€ChunkHashã€ContentHash åŒºåˆ«ï¼Ÿ**

| åç§°              | è®¡ç®—èŒƒå›´        | åœºæ™¯                   |
| --------------- | ----------- | -------------------- |
| **Hash**        | æ•´ä¸ªé¡¹ç›®çš„æ„å»ºç»“æœ   | æ”¹åŠ¨ä»»æ„æ–‡ä»¶éƒ½ä¼šæ”¹å˜           |
| **ChunkHash**   | å½“å‰ Chunk å†…å®¹ | æŸä¸ªå…¥å£ç‹¬ç«‹ç¼“å­˜             |
| **ContentHash** | æ–‡ä»¶å†…å®¹æœ¬èº«      | æ–‡ä»¶çº§ç¼“å­˜æœ€ç²¾ç»†ï¼ˆå¸¸ç”¨äº CSS/JSï¼‰ |

ğŸ§  **é¢è¯•æŠ€å·§**ï¼šè‹¥å¸Œæœ›ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ä¸å½±å“å…¶å®ƒç¼“å­˜ â†’ ä½¿ç”¨ `contenthash`ã€‚

---

### **9ï¸âƒ£ Webpack æ„å»ºæ—¶ä¸ºä»€ä¹ˆä¼šå¾ˆæ…¢ï¼Ÿ**

ä¸»è¦æ€§èƒ½ç“¶é¢ˆï¼š

1. **æ¨¡å—è¿‡å¤š / æ–‡ä»¶ä½“ç§¯å¤§**ï¼›
2. **Loader å¤„ç†æ…¢**ï¼ˆå¦‚ babel-loader æœªå¼€å¯ç¼“å­˜ï¼‰ï¼›
3. **SourceMap ç”Ÿæˆè€—æ—¶**ï¼›
4. **é¢‘ç¹ IO è¯»å†™æ–‡ä»¶**ï¼›
5. **æ’ä»¶æ•°é‡å¤šã€é€»è¾‘å¤æ‚**ï¼›
6. **æ— ç¼“å­˜ç¼–è¯‘**ï¼ˆæœªç”¨ `cache-loader`ã€`hard-source-webpack-plugin`ï¼‰ã€‚

---

### **ğŸ”Ÿ å¦‚ä½•åˆ†æ Webpack çš„æ‰“åŒ…æ€§èƒ½ç“¶é¢ˆï¼Ÿ**

å·¥å…·æ¨èï¼š

1. **webpack-bundle-analyzer**
   ğŸ‘‰ å¯è§†åŒ–ä¾èµ–åŒ…ä½“ç§¯ã€‚

   ```bash
   npm install webpack-bundle-analyzer -D
   ```

   åœ¨é…ç½®ä¸­ï¼š

   ```js
   const { BundleAnalyzerPlugin } = require('webpack-bundle-analyzer');
   plugins: [new BundleAnalyzerPlugin()]
   ```

2. **speed-measure-webpack-plugin (SMP)**
   ğŸ‘‰ åˆ†æå„æ’ä»¶å’Œ loader çš„è€—æ—¶ã€‚

   ```js
   const SpeedMeasurePlugin = require('speed-measure-webpack-plugin');
   const smp = new SpeedMeasurePlugin();
   module.exports = smp.wrap(webpackConfig);
   ```

3. **å¼€å¯ cache / thread-loader**
   ğŸ‘‰ å¯ç”¨å¤šçº¿ç¨‹ç¼–è¯‘ä¸ç¼“å­˜å‡å°‘é‡å¤å¤„ç†ã€‚

---

æ˜¯å¦å¸Œæœ›æˆ‘å¸®ä½ æ•´ç†æˆä¸€ä»½ã€ŒWebpack é«˜çº§é¢è¯•é¢˜ç­”æ¡ˆ PDFã€ï¼Ÿæˆ‘å¯ä»¥æŠŠè¿™ 10 ä¸ªé—®é¢˜å’Œå›ç­”æ ¼å¼åŒ–æ’ç‰ˆï¼Œæ–¹ä¾¿æ‰“å°å¤ä¹ ã€‚
