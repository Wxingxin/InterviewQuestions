# base

| ç‰¹æ€§         | é˜²æŠ–ï¼ˆDebounceï¼‰           | èŠ‚æµï¼ˆThrottleï¼‰           |
| ------------ | -------------------------- | -------------------------- |
| è§¦å‘é¢‘ç‡æ§åˆ¶ | äº‹ä»¶åœæ­¢åæ‰æ‰§è¡Œä¸€æ¬¡       | å›ºå®šé—´éš”å†…æ‰§è¡Œä¸€æ¬¡         |
| æ‰§è¡Œæ—¶æœº     | å»¶è¿Ÿæ‰§è¡Œï¼Œå¯èƒ½ä¸€æ¬¡ä¹Ÿä¸æ‰§è¡Œ | å‘¨æœŸæ€§æ‰§è¡Œï¼Œè‡³å°‘ä¼šæ‰§è¡Œä¸€æ¬¡ |
| å…¸å‹åœºæ™¯     | è¾“å…¥æ¡†ã€resize             | scrollã€æŒ‰é’®ç‚¹å‡»           |

1. é˜²æŠ– (debounce)

-  æœç´¢æ¡†è¾“å…¥ï¼ˆåœæ­¢è¾“å…¥åå†è¯·æ±‚æ¥å£ï¼‰
-  çª—å£å¤§å°å˜åŒ–ï¼ˆresizeï¼‰äº‹ä»¶
-  æŒ‰é’®ç‚¹å‡»é˜²æ­¢é‡å¤æäº¤

2. èŠ‚æµ (throttle)

-  æ»šåŠ¨åŠ è½½ï¼ˆscrollï¼‰
-  é¼ æ ‡ç§»åŠ¨ï¼ˆmousemoveï¼‰
-  é«˜é¢‘ç‚¹å‡»ï¼ˆæ¸¸æˆæŒ‰é”®ã€æŠ½å¥–æŒ‰é’®ï¼‰

### é˜²æŠ–

åœ¨äº‹ä»¶è§¦å‘å å»¶è¿Ÿä¸€æ®µæ—¶é—´å†æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…åˆè§¦å‘äº†äº‹ä»¶ï¼Œå°±é‡æ–°è®¡æ—¶ã€‚

```js
function debounce(fn, delay) {
   let timer;
   return function (...args) {
      clearTimeout(timer); // æ¯æ¬¡è§¦å‘éƒ½æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
      timer = setTimeout(() => {
         fn.apply(this, args);
      }, delay);
   };
}

// ä½¿ç”¨
const handleInput = debounce(() => {
   console.log("æœç´¢è¯·æ±‚å‘é€");
}, 500);

document.querySelector("input").addEventListener("input", handleInput);
```

### èŠ‚æµ

ä¿è¯åœ¨ä¸€æ®µæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ï¼Œä¸ç®¡äº‹ä»¶è¢«è§¦å‘å¤šå°‘æ¬¡ã€‚

```js
function throttle(fn, delay) {
   let startTime = 0;
   return function (...args) {
      const nowTime = Date.now();
      if (nowTime - startTime >= delay) {
         fn.apply(this, args);
         startTime = nowTime;
      }
   };
}

// ä½¿ç”¨
const handleScroll = throttle(() => {
   console.log("é¡µé¢æ»šåŠ¨ä¸­...");
}, 1000);

window.addEventListener("scroll", handleScroll);
```

# pro

### é˜²æŠ–ï¼ˆDebounceï¼‰

```js
function debounce(fn, delay = 300, immediate = false) {
   let timer = null;
   const debounced = function (...args) {
      const context = this;
      if (timer) clearTimeout(timer);

      if (immediate && !timer) {
         fn.apply(context, args); // ç«‹å³æ‰§è¡Œ
      }

      timer = setTimeout(() => {
         fn.apply(context, args);
         timer = null;
      }, delay);
   };

   debounced.cancel = function () {
      clearTimeout(timer);
      timer = null;
   };

   return debounced;
}
```

### ğŸ”¹ èŠ‚æµï¼ˆThrottleï¼‰

3. åŒä¿é™©ç‰ˆï¼ˆæ—¶é—´æˆ³ + å®šæ—¶å™¨ï¼‰

```js
function throttle(fn, delay = 300) {
   let last = 0;
   let timer = null;
   return function (...args) {
      const now = Date.now();
      const remaining = delay - (now - last);
      if (remaining <= 0) {
         if (timer) {
            clearTimeout(timer);
            timer = null;
         }
         fn.apply(this, args);
         last = now;
      } else if (!timer) {
         timer = setTimeout(() => {
            fn.apply(this, args);
            last = Date.now();
            timer = null;
         }, remaining);
      }
   };
}
```
