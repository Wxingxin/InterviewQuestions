# 📘 JavaScript 数组方法学习

---

## 一、改变原数组的方法（⚠️ 会直接修改原数组）

### 1. `push` / `pop`

```js
const arr = [1, 2, 3];
arr.push(4); // [1,2,3,4]
arr.pop(); // [1,2,3]
```

- **push**：返回新长度。
- **pop**：返回删除的元素。
- 🔥 性能好，推荐使用。

---

### 2. `shift` / `unshift`

```js
const arr = [1, 2, 3];
arr.shift(); // 返回 1 → [2,3]
arr.unshift(0); // 返回新长度 → [0,2,3]
```

- 头部操作，性能比 `push/pop` 差（需要移动元素）。

---

### 3. `splice(start, deleteCount, ...items)`

```js
let arr = [1, 2, 3, 4];
arr.splice(1, 2, "a", "b"); // [1,"a","b",4]
```

- 万能方法：增、删、改。
- 返回被删除的元素数组。

示例：

```js
// 删除
[1, 2, 3].splice(1, 1); // 删除索引 1 → [1,3]

// 插入
[1, 2, 3].splice(1, 0, "x"); // [1,"x",2,3]

// 替换
[1, 2, 3].splice(1, 1, "y"); // [1,"y",3]
```

---

### 4. `sort(fn)`

```js
[10, 5, 40].sort(); // [10,40,5] ❌ 按字符串
[10, 5, 40].sort((a, b) => a - b); // [5,10,40] ✅
```

- 默认按字符串排序。
- 需要传入比较函数。

⚠️ 注意：

```js
["b", "a", "c"].sort(); // ["a","b","c"]
```

---

### 5. `reverse()`

```js
[1, 2, 3].reverse(); // [3,2,1]
```

- 直接反转数组。

---

## 二、不改变原数组的方法（✅ 返回新数组，原数组不动）

### 1. `concat`

```js
const a = [1, 2];
const b = [3, 4];
a.concat(b); // [1,2,3,4]
```

- 合并数组/元素。
- 原数组不变。

---

### 2. `slice(start, end)`

```js
const arr = [1, 2, 3, 4];
arr.slice(1, 3); // [2,3]
arr.slice(-2); // [3,4]
```

- 截取数组，`end` 不包含。
- 常用于数组拷贝：`arr.slice()`。

---

### 3. `map`

```js
[1, 2, 3].map((x) => x * 2); // [2,4,6]
```

- 一一映射，返回新数组。
- ⚠️ 忘记 `return` 会得到 `[undefined,...]`。

---

### 4. `filter`

```js
[1, 2, 3, 4].filter((x) => x % 2 === 0); // [2,4]
```

- 筛选符合条件的元素。
- 返回新数组。

---

### 5. `reduce(fn, init)`

```js
arr.reduce((accumulator, currentValue, currentIndex, array) => {
  // 返回新的累积值
}, initialValue);
```

- accumulator：累计器，上一次回调的返回值
- currentValue：当前元素
- currentIndex：当前索引
- array：原数组
- initialValue：初始值（可选）
- ⚠️ 如果没有提供 initialValue，则 accumulator 默认是数组的第一个元素，currentValue 从第二个元素开始。
  例：扁平化

```js
nums = [1, 2, 3, 4];
const sum = nums.reduce((acc, cur) => acc + cur, 0);
console.log(sum); // 10
```

---

### 6. `flat(depth)`

```js
[1, [2, [3, [4]]]].flat(2); // [1,2,3,[4]]
[1, [2, [3, [4]]]].flat(Infinity); // 全部展开
```

- 扁平化数组，默认 depth = 1。

---

### 7. `flatMap(fn)`

```js
["hi", "world"].flatMap((x) => x.split(""));
// ["h","i","w","o","r","l","d"]
```

- 相当于 `map` + `flat(1)`。
- 比连续调用更高效。

---

## 三、对比总结

| 方法          | 是否改变原数组 | 返回值          | 主要用途       |
| ------------- | -------------- | --------------- | -------------- |
| push/pop      | ✅             | 新长度/删除元素 | 末尾增删       |
| shift/unshift | ✅             | 新长度/删除元素 | 头部增删       |
| splice        | ✅             | 删除的元素      | 增删改万能     |
| sort          | ✅             | 排序后的数组    | 排序           |
| reverse       | ✅             | 反转后的数组    | 翻转           |
| concat        | ❌             | 新数组          | 合并           |
| slice         | ❌             | 新数组          | 截取/复制      |
| map           | ❌             | 新数组          | 一一映射       |
| filter        | ❌             | 新数组          | 条件筛选       |
| reduce        | ❌             | 任意结果        | 累积、复杂逻辑 |
| flat          | ❌             | 新数组          | 扁平化         |
| flatMap       | ❌             | 新数组          | 映射+扁平化    |

---

## 四、常见陷阱

1. **sort 默认按字符串**

```js
[2, 11, 1].sort(); // [1,11,2]
```

2. **map 忘记 return**

```js
[1, 2, 3].map((x) => {
  x * 2;
}); // [undefined,undefined,undefined]
```

3. **splice 与 slice 混淆**

```js
let arr = [1, 2, 3];
arr.slice(1, 2); // [2]，不改原数组
arr.splice(1, 2); // 删除 [2,3]，改原数组
```

4. **flatMap 只能扁平化一层**

```js
[1, [2, [3]]].flatMap((x) => x); // [1,2,[3]]
```

---

✅ 总结：

- **改原数组**：push/pop/shift/unshift/splice/sort/reverse
- **不改原数组**：concat/slice/map/filter/reduce/flat/flatMap
- 使用时要注意 **是否会影响原数组**，这是面试常问的点。

---

要不要我帮你整理一份 **数组方法速查图（思维导图形式，改变 vs 不改变）**，让你一眼就能看出区别？
